<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="iaGuoZhi">
  <link rel="shortcut icon" href="https://blog.thea.codes/favicon.ico">

  <title>实用的命令行技巧 - iaGuoZhi</title>

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" href="https://blog.thea.codes/feed.xml" />

  <!-- Bootstrap core CSS -->
  <link href="/static/bootstrap.min.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="/static/style.css" rel="stylesheet">

  <!-- Syntax highlighting css -->
  <link href="/static/pygments.css" rel="stylesheet">

  
<meta property="og:title" content="实用的命令行技巧 - iaGuoZhi">
<meta property="twitter:title" content="实用的命令行技巧 - iaGuoZhi">







<meta property="og:url" content="https://blog.thea.codes/shell-comamnd-tips">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@theavalkyrie">

</head>
<body>
  <div class="container">

    
<article>
  <aside class="timestamp">
    <time>Posted by iaGuoZhi on July 09, 2022</time>
    · <a href="/">view all posts</a>
  </aside>
  <h1>实用的命令行技巧</h1>
  <content>
    <h1 id="_1">命令</h1>
<h2 id="_2">系统</h2>
<h3 id="systemctl">systemctl</h3>
<pre><code>sudo systemctl start docker
</code></pre>

<h3 id="pidof">pidof</h3>
<pre><code>pidof clash
</code></pre>

<h3 id="pidstat">pidstat</h3>
<p>查看每秒中CPU使用最多的10个进程</p>
<pre><code>pidstat -u | sort -nr -k 4 | head -5
</code></pre>

<h3 id="lspci">lspci</h3>
<p>显示所有PCI设备的设备名字(出厂型号)</p>
<pre><code>lspci -nn
</code></pre>

<h2 id="_3">文本&amp;文件</h2>
<h3 id="cat">cat</h3>
<p>制表符显示为^I</p>
<pre><code>cat -T file.py
</code></pre>

<h3 id="find">find</h3>
<p>找到所有.swp文件并删除</p>
<pre><code>find . -type f -name &quot;*.swp&quot; -delete
</code></pre>

<h3 id="xargs">xargs</h3>
<p>将args.txt中的每一行作为参数执行一次exec.sh</p>
<pre><code>cat args.txt | xargs -n 1 ./exec.sh
</code></pre>

<h3 id="tree">tree</h3>
<h3 id="_4">重定向</h3>
<h3 id="_5">软链接</h3>
<h3 id="_6">在浏览器中查看文件</h3>
<pre><code>python3 -m http.server 8080
</code></pre>

<h2 id="_7">磁盘</h2>
<h3 id="du">du</h3>
<p>查看各个当前各个目录中文件的总大小</p>
<pre><code>du -sh ./*
</code></pre>

<h3 id="dd">dd</h3>
<pre><code>sudo dd if=/dev/zero of=./virtio_blk.img bs=1M count=1024
sudo mkfs.ext3 ./virtio_blk.img
sudo sync
</code></pre>

<h3 id="lsblk">lsblk</h3>
<h3 id="mount">mount</h3>
<pre><code>mount -o loop=/dev/loop0 ./image ./mnt
</code></pre>

<h2 id="_8">网络</h2>
<h3 id="ssh">ssh</h3>
<p>反向转发, 用来作跳板机</p>
<pre><code>ssh -R 8000:localhost:80 user@REMOTE_MACHINE
</code></pre>

<p>之后用户访问远程主机的8000端口时，将重定位到本地机器的80端口</p>
<h3 id="ssh-copy-id">ssh-copy-id</h3>
<p>拷贝本地的public key到远程机器，之后登录不再需要输入密码</p>
<h3 id="ifconfig">ifconfig</h3>
<p>查看网络设备以及ip</p>
<pre><code>ifconfig -a
sudo ifconfig eth0 up
</code></pre>

<h3 id="dhclient">dhclient</h3>
<p>很多网络都使用动态主机配置协议(DHCP)来自动获取IP地址:</p>
<pre><code>dhclient eth0
</code></pre>

<h3 id="ping">ping</h3>
<p>测试网络连通性</p>
<pre><code>ping 192.168.16.14
</code></pre>

<h3 id="lsof">lsof</h3>
<p>列出正在使用某个开放端口的进程</p>
<pre><code>sudo lsof -i -P -n | grep 7890
</code></pre>

<h3 id="ip">ip</h3>
<p>ip用来起网桥，网桥用于两个独立的网络中传输数据</p>
<pre><code>ip link add br0 type bridge
ip link set dev eth1 master br0
# 配置网桥ip
ifconfig br0 10.0.0.2
# 启用分组转发
echo 1 &gt; /proc/sys/net/ipv4/ip_forward
</code></pre>

<h3 id="iptables">iptables</h3>
<p>防火墙设置</p>
<pre><code>sudo iptables --policy FORWARD ACCEPT
</code></pre>

<h3 id="tcpdump">tcpdump</h3>
<p>嗅探50个包，并保存</p>
<pre><code>tcpdump -w /tmp/tcpdump.raw -c 50
</code></pre>

<p>查看对应包的头部</p>
<pre><code>tcpdump -X -r /tmp/tcpdump.raw host google.com and port http
</code></pre>

<h3 id="arp">arp</h3>
<h2 id="_9">调试</h2>
<h3 id="gdb">gdb</h3>
<p>gdb 添加参数</p>
<pre><code>sudo gdb --args ./test --batch=2 --no-indirect
</code></pre>

<h3 id="dmesg">dmesg</h3>
<pre><code>sudo echo &quot;7&quot; &gt; /proc/sys/kernel/printk
</code></pre>

<h3 id="debugfs">debugfs</h3>
<p>挂载debugfs</p>
<pre><code>sudo mount -t debugfs none /sys/kernel/debug
</code></pre>

<h3 id="objdump">objdump</h3>
<pre><code>aarch64-linux-gnu-objdump -S --start-address=0x401524 ./user/build/vmm/vmm.bin | awk '{print $0} $3-/ret?/{exit}'
</code></pre>

<h3 id="qemu">qemu</h3>
<pre><code>qemu-aarch64 bomb
</code></pre>

<h3 id="readelf">readelf</h3>
<h2 id="_10">其他</h2>
<h3 id="docker">docker</h3>
<pre><code>docker run -it 14a6 /bin/bash
</code></pre>

<h3 id="ctags">ctags</h3>
<pre><code>ctags -R .
</code></pre>

<h3 id="clang-format">clang-format</h3>
<pre><code>clang-format -i -style=./.clang-format ./include/qemu/uri.h
</code></pre>

<h1 id="shell">Shell 语法</h1>
<h3 id="if">if</h3>
<pre><code>if [ -e $path ]; then
    echo &quot;File exists&quot;;
else
    echo &quot;Does not exist&quot;;
fi
</code></pre>

<h3 id="for">for</h3>
<pre><code>for num in {1..5}; do qemu-aarch64 bomb-${num} &lt; ans-${num}.txt; done
</code></pre>

<h1 id="_11">参考</h1>
  </content>
</article>


    <footer>
      <div class="row">
        <div class="col-md-1 d-none d-md-block img-me-container">
          <img class="img-me img-fluid" src="/static/me.jpg">
        </div>
        <div class="col-md info">
          <span class="name">iaGuoZhi</span><br>
          <!--<a href="https://thea.codes"><i class="fa fa-link" aria-hidden="true"></i> thea.codes</a>-->
          <a href="@zhiguo:matrix.org" rel="noopener"><i class="fab fa-matrix" aria-hidden="true"></i> Matrix</a>
          · <a href="https://github.com/iaguozhi" rel="noopener"><i class="fab fa-github" aria-hidden="true"></i> GitHub</a>
          · <a href="https://twitter.com/iaguozhi" rel="noopener"><i class="fab fa-twitter" aria-hidden="true"></i> Twitter</a>
          <br>
          <span class="location"><i class="fas fa-map-marker"></i> ShangHai, China</span>
        </div>
        <div class="col-md">
          <p class="disclaimer">
            &copy; 2022 &mdash; 2022<br>
            All text is available under the <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC-BY-SA 4.0</a> license<br>
            All code is available under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0</a> license
          </p>
      </div>

    </footer>
  </div>

  <!-- webfonts & icons-->
  <link href="/static/fontawesome/css/fontawesome-all.min.css" rel="stylesheet">

  <!-- Google Analytics (that's right, I'm tracking you) -->
  <script async="" src="https://www.google-analytics.com/analytics.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47725506-1', 'blog.thea.codes');
    ga('send', 'pageview');

  </script>

</body>
</html>